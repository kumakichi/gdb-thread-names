define show_thread_name
    set logging overwrite on
    set logging redirect on
    set height 0

    set logging file gdb_thread_dump1
    set logging on
    info threads
    set logging off

    set logging file gdb_thread_dump2
    set logging on
    thread apply all bt
    set logging off

    shell record_nums=$(awk 'END{print NR - 1}' gdb_thread_dump1);echo -e "Thread-Id\tThread-Func";awk '/start_thread/{print a;}{a=$0}END{print $0}' gdb_thread_dump2 | awk -v max=$record_nums '{print max+1-FNR,"\t\t",$4}'

    shell rm gdb_thread_dump1 gdb_thread_dump2
end

document show_thread_name
    show threads entry point function names

    ONLY works with POSIX standard thread library
end
